---
type: credential-inventory
decision: DECISION_168
date: 2026-02-26
---

# Credentials Inventory for ALMA QMD Railway Deployment

## Overview

This document lists ALL credentials, API keys, passwords, and secrets required for the ALMA QMD Railway deployment. All secrets must be stored in the encrypted vault at `C:\P4NTH30N\OP3NF1XER\nate-alma\secrets\`.

**Vault Initialization Sequence**:
1. Create directory: `mkdir -p C:\P4NTH30N\OP3NF1XER\nate-alma\secrets`
2. Generate encryption key: `$env:ALMA_SECRETS_KEY_B64 = [Convert]::ToBase64String((1..32 | % { Get-Random -Max 256 | % { [byte]$_ } }))`
3. Save key securely (password manager)
4. Initialize vault: `alma-secrets init`
5. Populate credentials per sequence below

## Pre-Deployment Credentials (You Must Provide)

### 1. OpenClaw Setup Password

| Field | Value |
|-------|-------|
| **Key** | `railway.openclaw.setup_password` |
| **Service** | OpenClaw |
| **Purpose** | Gate the initial setup wizard |
| **Format** | String, 16+ characters recommended |
| **Generated By** | You (or `alma-secrets` CLI) |
| **When Needed** | Pre-deploy |
| **Railway Variable** | `SETUP_PASSWORD` |

**Generation Command**:
```powershell
# Using alma-secrets CLI (after vault is initialized)
alma-secrets set railway.openclaw.setup_password --generate --length 24

# Or manually
alma-secrets set railway.openclaw.setup_password --value "your-secure-password-here"
```

### 2. OpenClaw Gateway Token

| Field | Value |
|-------|-------|
| **Key** | `railway.openclaw.gateway_token` |
| **Service** | OpenClaw |
| **Purpose** | Control UI authentication |
| **Format** | String, 32+ characters recommended |
| **Generated By** | You (or `alma-secrets` CLI) |
| **When Needed** | Pre-deploy |
| **Railway Variable** | `OPENCLAW_GATEWAY_TOKEN` |

**Generation Command**:
```powershell
alma-secrets set railway.openclaw.gateway_token --generate --length 32
```

### 3. SFTPGo Operator SSH Public Key

| Field | Value |
|-------|-------|
| **Key** | `sftpgo.operator.public_key` |
| **Service** | SFTPGo |
| **Purpose** | SSH key-only authentication |
| **Format** | SSH public key (ed25519 or rsa) |
| **Generated By** | You |
| **When Needed** | Pre-deploy OR post-deploy |
| **Railway Variable** | `SFTPGO_OPERATOR_KEY` |

**Generation Options**:

Option A - Generate new keypair:
```powershell
# Generate new keypair
ssh-keygen -t ed25519 -C "alma-operator@railway" -f ~/.ssh/alma-operator

# Store public key in vault
alma-secrets set sftpgo.operator.public_key --value (Get-Content ~/.ssh/alma-operator.pub)

# Store private key securely (local only, NOT in vault)
# ~/.ssh/alma-operator (keep local, backup securely)
```

Option B - Use existing key:
```powershell
# Use existing SSH key
alma-secrets set sftpgo.operator.public_key --value (Get-Content ~/.ssh/id_ed25519.pub)
```

### 4. Secrets Vault Encryption Key

| Field | Value |
|-------|-------|
| **Key** | `ALMA_SECRETS_KEY_B64` (environment variable) |
| **Service** | Secrets Vault |
| **Purpose** | Encrypt/decrypt the secrets store |
| **Format** | Base64-encoded 32 random bytes |
| **Generated By** | You |
| **When Needed** | Vault initialization |
| **Storage** | Environment variable ONLY (never commit) |

**Generation Command**:
```powershell
# Generate 32 random bytes, base64 encode
$key = [Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Maximum 256 } | ForEach-Object { [byte]$_ }))
$env:ALMA_SECRETS_KEY_B64 = $key
Write-Host "Set ALMA_SECRETS_KEY_B64 environment variable"
Write-Host "KEY (save this securely): $key"
```

**⚠️ CRITICAL**: This key is NOT stored in the vault itself. It encrypts the vault. Store it securely (password manager, etc.).

## Post-Deployment Credentials (Capture After Deploy)

### 5. MongoDB Connection URL

| Field | Value |
|-------|-------|
| **Key** | `railway.mongodb.mongo_url` |
| **Service** | MongoDB (Railway template) |
| **Purpose** | Database connection |
| **Format** | MongoDB connection string |
| **Generated By** | Railway |
| **When Needed** | Post-deploy (copy from Railway dashboard) |
| **Railway Variable** | `MONGO_URL` (auto-generated) |

**Capture Command**:
```powershell
# Get from Railway CLI
$mongoUrl = railway variables get MONGO_URL --service "alma-qmd"
alma-secrets set railway.mongodb.mongo_url --value $mongoUrl
```

### 6. SFTPGo Host Key Fingerprint

| Field | Value |
|-------|-------|
| **Key** | `sftpgo.hostkey.fingerprint_sha256` |
| **Service** | SFTPGo |
| **Purpose** | Verify SFTP server identity |
| **Format** | SHA256 fingerprint string |
| **Generated By** | First deploy |
| **When Needed** | Post-deploy |
| **Railway Variable** | N/A (captured via SSH) |

**Capture Command**:
```powershell
# Get TCP endpoint from Railway
$sftpHost = railway tcp-proxy get --service "alma-qmd" --port 2022

# Get fingerprint
$fp = ssh-keyscan -p 2022 $sftpHost 2>$null | ssh-keygen -lf -
alma-secrets set sftpgo.hostkey.fingerprint_sha256 --value $fp
```

### 7. Railway Service Domain

| Field | Value |
|-------|-------|
| **Key** | `railway.service.domain` |
| **Service** | Railway |
| **Purpose** | Public HTTPS endpoint |
| **Format** | URL string |
| **Generated By** | Railway |
| **When Needed** | Post-deploy |
| **Railway Variable** | Auto-generated |

**Capture Command**:
```powershell
$domain = railway domain --service "alma-qmd"
alma-secrets set railway.service.domain --value $domain
```

## Environment Variables Summary

### Railway Environment Variables

| Variable Name | Source | Value Location in Vault |
|---------------|--------|------------------------|
| `SETUP_PASSWORD` | You generate | `railway.openclaw.setup_password` |
| `OPENCLAW_GATEWAY_TOKEN` | You generate | `railway.openclaw.gateway_token` |
| `OLLAMA_API_KEY` | Hardcoded | Set to `"ollama-local"` |
| `MONGO_URL` | Railway template | `railway.mongodb.mongo_url` |
| `SFTPGO_OPERATOR_KEY` | You provide | `sftpgo.operator.public_key` |
| `QMD_ENABLED` | Hardcoded | Set to `"true"` |

### Local Environment Variables

| Variable Name | Purpose | When Set |
|---------------|---------|----------|
| `ALMA_SECRETS_KEY_B64` | Vault encryption | Before any vault operation |

## Credentials Checklist

### Pre-Deploy (Before First Deploy)

- [ ] `ALMA_SECRETS_KEY_B64` environment variable set
- [ ] Secrets vault initialized (`alma-secrets init`)
- [ ] `railway.openclaw.setup_password` generated and stored
- [ ] `railway.openclaw.gateway_token` generated and stored
- [ ] `sftpgo.operator.public_key` generated or provided
- [ ] SSH private key saved locally (if new keypair generated)

### Post-Deploy (After Railway Deploy)

- [ ] `railway.mongodb.mongo_url` captured from Railway
- [ ] `sftpgo.hostkey.fingerprint_sha256` captured via SSH
- [ ] `railway.service.domain` captured from Railway
- [ ] All secrets verified retrievable from vault

## Security Policy

### DO
- ✅ Generate strong passwords (24+ chars)
- ✅ Use ed25519 SSH keys
- ✅ Store `ALMA_SECRETS_KEY_B64` in password manager
- ✅ Verify vault encryption before storing secrets
- ✅ Keep SSH private keys local only
- ✅ Use Railway private networking for MongoDB

### DO NOT
- ❌ Commit any secrets to git
- ❌ Store `ALMA_SECRETS_KEY_B64` in vault
- ❌ Share SSH private keys
- ❌ Use password auth for SFTPGo
- ❌ Enable MongoDB TCP proxy
- ❌ Use paid LLM API keys (deployment uses Ollama only)

## Emergency Access

### If Vault Key Lost

1. Generate new vault key
2. Re-create all secrets from backups/memory
3. Update Railway variables with new values
4. Re-deploy if necessary

### If Railway Access Lost

1. Use `railway login` to re-authenticate
2. Project access is tied to Railway account
3. Contact Railway support if account issues

## Verification Commands

```powershell
# Verify vault is accessible
alma-secrets list

# Verify specific secrets exist
alma-secrets get railway.openclaw.setup_password
alma-secrets get railway.openclaw.gateway_token
alma-secrets get sftpgo.operator.public_key

# Verify Railway variables are set
railway variables --service "alma-qmd"
```
